"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4315],{385:(D,P,n)=>{n.d(P,{l:()=>d});var s=n(4438),l=n(7863);let d=(()=>{var m;class u{constructor(){this.titulo=""}Salir(){}}return(m=u).\u0275fac=function(e){return new(e||m)},m.\u0275cmp=s.VBU({type:m,selectors:[["app-header"]],inputs:{titulo:"titulo"},decls:5,vars:2,consts:[[3,"translucent"],["color","primary"],["slot","end"]],template:function(e,t){1&e&&(s.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),s.EFF(3),s.k0s(),s.nrm(4,"ion-buttons",2),s.k0s()()),2&e&&(s.Y8G("translucent",!0),s.R7$(3),s.JRh(t.titulo))},dependencies:[l.QW,l.eU,l.BC,l.ai]}),u})()},4315:(D,P,n)=>{n.r(P),n.d(P,{TestPageModule:()=>A});var s=n(177),l=n(4341),d=n(7863),m=n(8986),u=n(467),h=n(5312),e=n(4438),t=n(431),a=n(7291),o=n(8856),p=n(385);function g(c,T){if(1&c){const v=e.RV6();e.j41(0,"ion-card")(1,"fieldset",6)(2,"legend"),e.EFF(3,"Cantidad a transferir"),e.k0s(),e.j41(4,"ion-input",14),e.mxI("ngModelChange",function(i){e.eBV(v);const _=e.XpG();return e.DH7(_.importeTransferencia,i)||(_.importeTransferencia=i),e.Njj(i)}),e.k0s()(),e.j41(5,"ion-button",15),e.bIt("click",function(){e.eBV(v);const i=e.XpG();return e.Njj(i.transferirDistribuidora())}),e.EFF(6," Transferir a distribuidora "),e.k0s()()}if(2&c){const v=e.XpG();e.R7$(4),e.R50("ngModel",v.importeTransferencia)}}const y=[{path:"",component:(()=>{var c;class T{constructor(r,i,_,E){this.stellar=r,this.disco=i,this.oCom=_,this.loadingCtrl=E,this.saldoCrypto=0,this.importeTransferencia=0,this.esComercio="beneficiario"!=h.c.clase,this.mensaje=""}ngOnInit(){this.refrescarSaldo()}showLoading(){var r=this;return(0,u.A)(function*(){(yield r.loadingCtrl.create({showBackdrop:!0,backdropDismiss:!1,translucent:!0,duration:0,mode:"ios"})).present()})()}onClick(){}refrescarSaldo(){var r=this;return(0,u.A)(function*(){r.stellar.miSaldo(h.c.secretUsuario).then(i=>{console.log(i),i.forEach(_=>{console.log("moneda",_),"credit_alphanum4"==_.asset_type&&(r.saldoCrypto=parseInt(_.balance))})})})()}botonGrabar(){}botonLeer(){this.disco.cargarUsuario().then(function(i){console.log("muestro usuarios",i)})}transferirDistribuidora(){var r=this;return(0,u.A)(function*(){r.showLoading();let i=yield r.oCom.getTokenPromise(h.c.login,h.c.password);""!=i&&r.oCom.getEstadoCuenta(h.c.publicUsuario,i).then(_=>{try{console.log(_),r.stellar.TransferirCripto(_.distribuidora,h.c.secretUsuario,_.emisora,r.importeTransferencia),setTimeout(()=>{r.mensaje="Transferencia realizada",r.refrescarSaldo(),r.loadingCtrl.dismiss()},1e4)}catch(E){r.mensaje="Error realizando transferencia",console.log("ha petao",E),setTimeout(()=>{r.loadingCtrl.dismiss()},3e3)}})})()}}return(c=T).\u0275fac=function(r){return new(r||c)(e.rXU(t.x),e.rXU(a.n),e.rXU(o.M),e.rXU(d.Xi))},c.\u0275cmp=e.VBU({type:c,selectors:[["app-test"]],decls:22,vars:5,consts:[[3,"titulo"],[1,"ion-padding",3,"fullscreen"],[1,"heading"],[1,"para"],["fixed",""],["size","9"],[1,"input-item"],["type","text","placeholder","","name","txtSaldo",3,"ngModelChange","ngModel"],["size","3"],["shape","round","expand","block",3,"click"],["name","refresh"],[4,"ngIf"],["color","white"],[1,"copyright"],["type","text","placeholder","","name","txtImporte",3,"ngModelChange","ngModel"],["expand","block","shape","round",3,"click"]],template:function(r,i){1&r&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"h1",2),e.EFF(3,"Comunitaria"),e.nrm(4,"br")(5,"br"),e.k0s(),e.j41(6,"p",3),e.EFF(7,"\xc9ste es su saldo en ILLAs"),e.k0s(),e.j41(8,"ion-grid",4)(9,"ion-row")(10,"ion-col",5)(11,"ion-item")(12,"fieldset",6)(13,"ion-input",7),e.mxI("ngModelChange",function(E){return e.DH7(i.saldoCrypto,E)||(i.saldoCrypto=E),E}),e.k0s()()()(),e.j41(14,"ion-col",8)(15,"ion-button",9),e.bIt("click",function(){return i.refrescarSaldo()}),e.nrm(16,"ion-icon",10),e.k0s()()()(),e.DNE(17,g,7,1,"ion-card",11),e.k0s(),e.j41(18,"ion-footer",12)(19,"ion-toolbar")(20,"p",13),e.EFF(21),e.k0s()()()),2&r&&(e.Y8G("titulo","Inicio"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(12),e.R50("ngModel",i.saldoCrypto),e.R7$(4),e.Y8G("ngIf",i.esComercio),e.R7$(4),e.JRh(i.mensaje))},dependencies:[s.bT,l.BC,l.vS,d.Jm,d.b_,d.hU,d.W9,d.M0,d.lO,d.iq,d.$w,d.uz,d.ln,d.ai,d.Gw,p.l]}),T})()}];let C=(()=>{var c;class T{}return(c=T).\u0275fac=function(r){return new(r||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=e.G2t({imports:[m.iI.forChild(y),m.iI]}),T})();var f=n(5553);let A=(()=>{var c;class T{}return(c=T).\u0275fac=function(r){return new(r||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=e.G2t({imports:[s.MD,l.YN,d.bv,C,f.h]}),T})()},8856:(D,P,n)=>{n.d(P,{M:()=>h});var s=n(467),l=n(1626),d=n(5312),m=n(4438);const u=d.c.servidorVst;let h=(()=>{var e;class t{constructor(o){this.http=o}getToken(o="",p=""){let g=new l.Lr;const M=(new l.Nl).set("username",o).set("password",p).set("grant_type","password");return g.append("Content-Type","application/x-www-form-urlencoded"),this.http.post(u+"login",M,{headers:g})}getTokenPromise(o="",p=""){var g=this;return(0,s.A)(function*(){return new Promise((M,y)=>{let C=new l.Lr;const f=(new l.Nl).set("username",o).set("password",p).set("grant_type","password");C.append("Content-Type","application/x-www-form-urlencoded"),g.http.post(u+"login",f,{headers:C}).subscribe({next:A=>{M(A.access_token)},error:A=>{y("")}})})})()}getEstadoCuenta(o="",p=""){var g=this;return(0,s.A)(function*(){return new Promise((M,y)=>{const C=(new l.Lr).set("Authorization","Bearer "+p);g.http.get(u+"cuenta/"+o,{headers:C}).subscribe({next:f=>{console.log("valor",f),M(f)},error:f=>{y("")}})})})()}registrarCuenta(o="",p=""){const g=(new l.Lr).set("Authorization","Bearer "+p);return console.log(p),g.set("Accept","*/*"),g.set("Connection","keep-alive"),this.http.post(u+"cuenta/"+o,null,{headers:g})}autorizarCuenta(o="",p=""){const g=(new l.Lr).set("Authorization","Bearer "+p);return console.log(p),g.set("Accept","*/*"),g.set("Connection","keep-alive"),this.http.post(u+"cuenta/"+o+"/autorizacion",null,{headers:g})}getComercios(o=""){let p=(new l.Lr).set("Authorization","Bearer "+o);return p.append("Content-Type","application/json"),this.http.get(u+"comercios",{headers:p})}getUnComercio(o="",p=""){var g=this;return(0,s.A)(function*(){return yield new Promise((M,y)=>{let C=(new l.Lr).set("Authorization","Bearer "+o);C.append("Content-Type","application/json"),g.http.get(u+"comercio/"+p,{headers:C}).subscribe({next:f=>{M(f)},error:f=>{y("")}})})})()}}return(e=t).\u0275fac=function(o){return new(o||e)(m.KVO(l.Qq))},e.\u0275prov=m.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),t})()},7291:(D,P,n)=>{n.d(P,{n:()=>m});var s=n(467),l=n(4438),d=n(369);let m=(()=>{var u;class h{constructor(t){this.storage=t,this.tiendas=[],this.usuario={},this._storage=null,this.init()}init(){var t=this;return(0,s.A)(function*(){const a=yield t.storage.create();t._storage=a})()}guardarUsuario(t){var a=this;return(0,s.A)(function*(){var o;console.log("storage",t),null===(o=a._storage)||void 0===o||o.set("usuario",t)})()}cargarUsuario(){var t=this;return(0,s.A)(function*(){var a;return t.usuario=yield null===(a=t._storage)||void 0===a?void 0:a.get("usuario"),t.usuario||[]})()}guardarTiendas(t){var a=this;return(0,s.A)(function*(){var o;console.log("storage",t),null===(o=a._storage)||void 0===o||o.set("tiendas",t),console.log("storage2",t)})()}cargarTiendas(){var t=this;return(0,s.A)(function*(){var a;const o=yield null===(a=t._storage)||void 0===a?void 0:a.get("tiendas");return t.tiendas=null!=o?o:[],t.tiendas})()}borrarTiendas(){var t=this;return(0,s.A)(function*(){var a;yield null===(a=t._storage)||void 0===a?void 0:a.remove("tiendas")})()}borrarUsuario(){var t=this;return(0,s.A)(function*(){var a;yield null===(a=t._storage)||void 0===a?void 0:a.remove("usuario")})()}}return(u=h).\u0275fac=function(t){return new(t||u)(l.KVO(d.w))},u.\u0275prov=l.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),h})()}}]);